/* LiveKit toolbar responsive overrides */

/* Target common LiveKit toolbar class names and the data-lk-theme container */
[data-lk-theme] .lk-toolbar,
[data-lk-theme] .lk-controls,
[data-lk-theme] .lk-video-conference__toolbar,
.lk-toolbar,
.lk-controls,
.livekit-toolbar,
.lk-video-conference__controls {
  display: flex !important;
  flex-wrap: wrap !important;
  gap: 0.5rem !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 0.25rem !important;
  box-sizing: border-box !important;
}

/* Ensure toolbars do not cause horizontal overflow */
[data-lk-theme] .lk-toolbar,
.lk-toolbar {
  max-width: 100% !important;
  overflow-x: auto !important;
}

/* Wrapper ensures LiveKit content fits inside the card and doesn't cause outer overflow */
.livekit-wrapper {
  width: 100%;
  box-sizing: border-box;
  overflow: hidden;
}

/* Make sure the video conference area doesn't add lateral padding that causes overflow */
.livekit-wrapper .lk-video-conference,
.livekit-wrapper .lk-VideoConference,
.livekit-wrapper video,
.livekit-wrapper .lk-video-grid {
  max-width: 100% !important;
  box-sizing: border-box !important;
}

/* Stronger toolbar rules to respect wrapper padding and avoid bleeding */
[data-lk-theme] .lk-toolbar,
.lk-toolbar {
  position: relative !important;
  width: calc(100% - 2rem) !important; /* respect card horizontal padding */
  margin: 0 auto !important;
  left: 0 !important;
  right: 0 !important;
  box-sizing: border-box !important;
}

/* Ensure toolbar buttons wrap into rows rather than overflow the parent */
[data-lk-theme] .lk-toolbar .lk-button,
.lk-toolbar .lk-button,
[data-lk-theme] .lk-toolbar button,
.lk-toolbar button {
  white-space: nowrap !important;
}

/* Make individual controls shrink on small screens */
[data-lk-theme] .lk-toolbar button,
[data-lk-theme] .lk-toolbar .lk-button,
.lk-toolbar button,
.lk-toolbar .lk-button {
  flex: 0 0 auto !important;
  min-width: 36px !important;
  padding: 6px 8px !important;
  font-size: 13px !important;
}

/* Breakpoints: tweak sizes for medium and small screens */
@media (max-width: 1024px) {
  [data-lk-theme] .lk-toolbar button,
  .lk-toolbar button {
    padding: 6px 6px !important;
    font-size: 12px !important;
  }
}

@media (max-width: 768px) {
  [data-lk-theme] .lk-toolbar,
  .lk-toolbar {
    justify-content: flex-start !important;
    gap: 0.25rem !important;
    overflow-x: auto !important;
    padding: 0.25rem !important;
  }

  /* Make toolbar buttons compact on 768px so controls stay visible */
  [data-lk-theme] .lk-toolbar button,
  .lk-toolbar button,
  [data-lk-theme] .lk-button,
  .lk-button {
    min-width: 34px !important;
    height: 34px !important;
    padding: 4px !important;
    font-size: 11px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  /* Hide common label/text nodes inside the buttons to reduce width */
  [data-lk-theme] .lk-toolbar button span,
  .lk-toolbar button span,
  [data-lk-theme] .lk-toolbar button .label,
  .lk-toolbar button .label,
  [data-lk-theme] .lk-toolbar button .lk-button__text,
  .lk-toolbar button .lk-button__text,
  .lk-button__text,
  .lk-button__label {
    display: none !important;
  }

  /* Ensure toolbar respects container width and shows scrollbar if needed */
  [data-lk-theme] .lk-toolbar,
  .lk-toolbar {
    max-width: 100% !important;
    box-sizing: border-box !important;
  }
}

@media (max-width: 425px) {
  [data-lk-theme] .lk-toolbar,
  .lk-toolbar {
    justify-content: flex-start !important;
  }
  [data-lk-theme] .lk-toolbar button,
  .lk-toolbar button {
    padding: 4px 6px !important;
    font-size: 11px !important;
  }
}

/* Extra-small breakpoints: force icon-only compact toolbar and keep controls visible */
@media (max-width: 375px) {
  [data-lk-theme] .lk-toolbar,
  .lk-toolbar {
    justify-content: flex-start !important;
    gap: 0.25rem !important;
    overflow-x: auto !important; /* allow horizontal scroll if still crowded */
  }

  /* Make toolbar buttons compact and square, center icon content */
  [data-lk-theme] .lk-toolbar button,
  .lk-toolbar button,
  [data-lk-theme] .lk-button,
  .lk-button {
    min-width: 32px !important;
    height: 32px !important;
    padding: 4px !important;
    font-size: 10px !important;
    display: inline-flex !important;
    align-items: center !important;
    justify-content: center !important;
  }

  /* Hide textual labels inside toolbar buttons to preserve space (try several common selectors) */
  [data-lk-theme] .lk-toolbar button span,
  .lk-toolbar button span,
  [data-lk-theme] .lk-toolbar button .label,
  .lk-toolbar button .label,
  [data-lk-theme] .lk-toolbar button .lk-button__text,
  .lk-toolbar button .lk-button__text,
  .lk-button__text,
  .lk-button__label {
    display: none !important;
    width: 0 !important;
    height: 0 !important;
    overflow: hidden !important;
    margin: 0 !important;
    padding: 0 !important;
  }
}

@media (max-width: 320px) {
  [data-lk-theme] .lk-toolbar button,
  .lk-toolbar button,
  .lk-button {
    min-width: 28px !important;
    height: 28px !important;
    padding: 3px !important;
    font-size: 9px !important;
  }

  /* Further reduce gaps so the toolbar fits better; keep ability to scroll horizontally */
  [data-lk-theme] .lk-toolbar,
  .lk-toolbar {
    gap: 0.125rem !important;
    padding: 0.125rem !important;
  }
}

/* Chat input / Send button: ensure the input doesn't push the send button off-screen on small widths */
.livekit-wrapper .lk-chat,
.livekit-wrapper .lk-chatbox,
.livekit-wrapper .alt-live-chat,
.livekit-wrapper .chat-container {
  box-sizing: border-box !important;
}

.livekit-wrapper input[type="text"],
.livekit-wrapper input[type="search"],
.livekit-wrapper textarea {
  max-width: calc(100% - 80px) !important; /* leave room for send button */
  box-sizing: border-box !important;
}

.livekit-wrapper button[type="submit"],
.livekit-wrapper .send-button,
.livekit-wrapper .lk-send-button,
.livekit-wrapper .chat-send-button {
  flex: 0 0 auto !important;
  margin-left: 6px !important;
  min-width: 44px !important;
}

/* Last-resort: if toolbar still overflows visually, allow a subtle horizontal scrollbar on the toolbar area */
[data-lk-theme] .lk-toolbar::-webkit-scrollbar,
.lk-toolbar::-webkit-scrollbar {
  height: 6px;
}
[data-lk-theme] .lk-toolbar::-webkit-scrollbar-thumb,
.lk-toolbar::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.2);
  border-radius: 3px;
}

/* When runtime helper marks the toolbar, apply very specific compact rules */
.compact-livekit-toolbar {
  display: flex !important;
  flex-wrap: nowrap !important; /* prefer horizontal compact layout */
  gap: 0.25rem !important;
  align-items: center !important;
  justify-content: flex-start !important;
  padding: 0.125rem !important;
  overflow-x: auto !important;
  max-width: 100% !important;
}

.compact-livekit-toolbar button,
.compact-livekit-toolbar .lk-button {
  min-width: 30px !important;
  height: 30px !important;
  padding: 3px !important;
  font-size: 10px !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
}

.compact-livekit-toolbar button span,
.compact-livekit-toolbar .lk-button__text,
.compact-livekit-toolbar .label {
  display: none !important;
}

/* Encourage toolbar to be scrollable horizontally on narrow viewports */
.compact-livekit-toolbar::-webkit-scrollbar {
  height: 6px;
}
.compact-livekit-toolbar::-webkit-scrollbar-thumb {
  background: rgba(0,0,0,0.15);
  border-radius: 3px;
}
